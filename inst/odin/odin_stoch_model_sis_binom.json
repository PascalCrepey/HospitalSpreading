{"version":"1.4.5","config":{"base":"odin_stoch_model_sis_binom","include":null,"custom":null},"meta":{"internal":"internal","user":"user","state":"state","result":"state_next","output":"output","time":"step","initial_time":"initial_step"},"features":{"continuous":false,"discrete":true,"mixed":false,"has_array":true,"has_output":true,"has_user":true,"has_delay":false,"has_interpolate":false,"has_stochastic":true,"has_include":false,"has_debug":false,"initial_time_dependent":false},"data":{"elements":[{"name":"alpha","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"beta","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"com_p","location":"internal","storage_type":"double","rank":0,"dimnames":null,"stage":"user"},{"name":"d","location":"internal","storage_type":"double","rank":2,"dimnames":{"length":"dim_d","dim":["dim_d_1","dim_d_2"],"mult":["","dim_d_1"]},"stage":"user"},{"name":"dim_d","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_d_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_d_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_I","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_i_initial","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_I_temp","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_N_temp","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_new_I","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_new_S","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_S","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_s_initial","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_S_prev","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_S_temp","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_t_I","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_t_I_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_t_I_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_t_S","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_t_S_1","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_t_S_2","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"dim_t_S_out","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"I","location":"variable","storage_type":"double","rank":1,"dimnames":{"length":"dim_I","dim":[],"mult":[]},"stage":"time"},{"name":"i_initial","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_i_initial","dim":[],"mult":[]},"stage":"user"},{"name":"I_temp","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_I_temp","dim":[],"mult":[]},"stage":"time"},{"name":"initial_I","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_I","dim":[],"mult":[]},"stage":"user"},{"name":"initial_S","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_S","dim":[],"mult":[]},"stage":"user"},{"name":"N","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_N","dim":[],"mult":[]},"stage":"user"},{"name":"n_com_subpop","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"n_subpop","location":"internal","storage_type":"int","rank":0,"dimnames":null,"stage":"user"},{"name":"N_temp","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_N_temp","dim":[],"mult":[]},"stage":"time"},{"name":"new_I","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_new_I","dim":[],"mult":[]},"stage":"time"},{"name":"new_S","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_new_S","dim":[],"mult":[]},"stage":"time"},{"name":"S","location":"variable","storage_type":"double","rank":1,"dimnames":{"length":"dim_S","dim":[],"mult":[]},"stage":"time"},{"name":"s_initial","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_s_initial","dim":[],"mult":[]},"stage":"user"},{"name":"S_prev","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_S_prev","dim":[],"mult":[]},"stage":"time"},{"name":"S_temp","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_S_temp","dim":[],"mult":[]},"stage":"time"},{"name":"t_I","location":"internal","storage_type":"double","rank":2,"dimnames":{"length":"dim_t_I","dim":["dim_t_I_1","dim_t_I_2"],"mult":["","dim_t_I_1"]},"stage":"time"},{"name":"t_S","location":"internal","storage_type":"double","rank":2,"dimnames":{"length":"dim_t_S","dim":["dim_t_S_1","dim_t_S_2"],"mult":["","dim_t_S_1"]},"stage":"time"},{"name":"t_S_out","location":"internal","storage_type":"double","rank":1,"dimnames":{"length":"dim_t_S_out","dim":[],"mult":[]},"stage":"time"}],"variable":{"length":["+","dim_I","dim_S"],"contents":[{"name":"S","offset":0,"initial":"initial_S"},{"name":"I","offset":"dim_S","initial":"initial_I"}]},"output":{"length":["+","dim_new_I","dim_t_I"],"contents":[{"name":"new_I","offset":0},{"name":"t_I","offset":"dim_new_I"}]}},"equations":[{"name":"alloc_I_temp","type":"alloc","source":[22],"depends":{"functions":[],"variables":["dim_I_temp"]},"lhs":"I_temp"},{"name":"alloc_initial_I","type":"alloc","source":[20],"depends":{"functions":[],"variables":["dim_I"]},"lhs":"initial_I"},{"name":"alloc_initial_S","type":"alloc","source":[19],"depends":{"functions":[],"variables":["dim_S"]},"lhs":"initial_S"},{"name":"alloc_N_temp","type":"alloc","source":[28],"depends":{"functions":[],"variables":["dim_N_temp"]},"lhs":"N_temp"},{"name":"alloc_new_I","type":"alloc","source":[24],"depends":{"functions":[],"variables":["dim_new_I"]},"lhs":"new_I"},{"name":"alloc_new_S","type":"alloc","source":[23],"depends":{"functions":[],"variables":["dim_new_S"]},"lhs":"new_S"},{"name":"alloc_S_prev","type":"alloc","source":[30],"depends":{"functions":[],"variables":["dim_S_prev"]},"lhs":"S_prev"},{"name":"alloc_S_temp","type":"alloc","source":[21],"depends":{"functions":[],"variables":["dim_S_temp"]},"lhs":"S_temp"},{"name":"alloc_t_I","type":"alloc","source":[35],"depends":{"functions":[],"variables":["dim_t_I"]},"lhs":"t_I"},{"name":"alloc_t_S","type":"alloc","source":[34],"depends":{"functions":[],"variables":["dim_t_S"]},"lhs":"t_S"},{"name":"alloc_t_S_out","type":"alloc","source":[33],"depends":{"functions":[],"variables":["dim_t_S_out"]},"lhs":"t_S_out"},{"name":"alpha","type":"user","source":[6],"depends":null,"lhs":"alpha","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"beta","type":"user","source":[5],"depends":null,"lhs":"beta","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"com_p","type":"user","source":[16],"depends":null,"lhs":"com_p","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"d","type":"user","source":[14],"depends":{"functions":["dim"],"variables":["dim_d"]},"lhs":"d","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"dim_d","type":"expression_scalar","source":[32],"depends":{"functions":[],"variables":["dim_d_1","dim_d_2"]},"lhs":"dim_d","rhs":{"value":["*","dim_d_1","dim_d_2"]}},{"name":"dim_d_1","type":"expression_scalar","source":[32],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_d_1","rhs":{"value":"n_com_subpop"}},{"name":"dim_d_2","type":"expression_scalar","source":[32],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_d_2","rhs":{"value":"n_com_subpop"}},{"name":"dim_I","type":"expression_scalar","source":[20],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_I","rhs":{"value":"n_subpop"}},{"name":"dim_i_initial","type":"expression_scalar","source":[26],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_i_initial","rhs":{"value":"n_subpop"}},{"name":"dim_I_temp","type":"expression_scalar","source":[22],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_I_temp","rhs":{"value":"n_subpop"}},{"name":"dim_N","type":"expression_scalar","source":[27],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_N","rhs":{"value":"n_subpop"}},{"name":"dim_N_temp","type":"expression_scalar","source":[28],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_N_temp","rhs":{"value":"n_subpop"}},{"name":"dim_new_I","type":"expression_scalar","source":[24],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_new_I","rhs":{"value":"n_subpop"}},{"name":"dim_new_S","type":"expression_scalar","source":[23],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_new_S","rhs":{"value":"n_subpop"}},{"name":"dim_S","type":"expression_scalar","source":[19],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_S","rhs":{"value":"n_subpop"}},{"name":"dim_s_initial","type":"expression_scalar","source":[25],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_s_initial","rhs":{"value":"n_subpop"}},{"name":"dim_S_prev","type":"expression_scalar","source":[30],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_S_prev","rhs":{"value":"n_com_subpop"}},{"name":"dim_S_temp","type":"expression_scalar","source":[21],"depends":{"functions":[],"variables":["n_subpop"]},"lhs":"dim_S_temp","rhs":{"value":"n_subpop"}},{"name":"dim_t_I","type":"expression_scalar","source":[35],"depends":{"functions":[],"variables":["dim_t_I_1","dim_t_I_2"]},"lhs":"dim_t_I","rhs":{"value":["*","dim_t_I_1","dim_t_I_2"]}},{"name":"dim_t_I_1","type":"expression_scalar","source":[35],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_t_I_1","rhs":{"value":"n_com_subpop"}},{"name":"dim_t_I_2","type":"expression_scalar","source":[35],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_t_I_2","rhs":{"value":"n_com_subpop"}},{"name":"dim_t_S","type":"expression_scalar","source":[34],"depends":{"functions":[],"variables":["dim_t_S_1","dim_t_S_2"]},"lhs":"dim_t_S","rhs":{"value":["*","dim_t_S_1","dim_t_S_2"]}},{"name":"dim_t_S_1","type":"expression_scalar","source":[34],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_t_S_1","rhs":{"value":"n_com_subpop"}},{"name":"dim_t_S_2","type":"expression_scalar","source":[34],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_t_S_2","rhs":{"value":"n_com_subpop"}},{"name":"dim_t_S_out","type":"expression_scalar","source":[33],"depends":{"functions":[],"variables":["n_com_subpop"]},"lhs":"dim_t_S_out","rhs":{"value":"n_com_subpop"}},{"name":"i_initial","type":"user","source":[12],"depends":{"functions":["length"],"variables":["dim_i_initial"]},"lhs":"i_initial","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"I_temp","type":"expression_array","source":[54],"depends":{"functions":["length","+","-","[","odin_sum","dim"],"variables":["dim_I_temp","I","i","t_I","dim_t_I","alloc_I_temp"]},"lhs":"I_temp","rhs":[{"index":[{"value":[":",1,["length","I_temp"]],"is_range":true,"index":"i"}],"value":["+",["-",["[","I","i"],["odin_sum","t_I","i","i",1,["dim","t_I",2]]],["odin_sum","t_I",1,["dim","t_I",1],"i","i"]]}]},{"name":"initial_I","type":"expression_array","source":[68],"depends":{"functions":["length","["],"variables":["dim_I","i_initial","i"]},"lhs":"initial_I","rhs":[{"index":[{"value":[":",1,["length","I"]],"is_range":true,"index":"i"}],"value":["[","i_initial","i"]}]},{"name":"initial_S","type":"expression_array","source":[67],"depends":{"functions":["length","["],"variables":["dim_S","s_initial","i"]},"lhs":"initial_S","rhs":[{"index":[{"value":[":",1,["length","S"]],"is_range":true,"index":"i"}],"value":["[","s_initial","i"]}]},{"name":"N","type":"user","source":[13],"depends":{"functions":["length"],"variables":["dim_N"]},"lhs":"N","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"n_com_subpop","type":"user","source":[9],"depends":null,"lhs":"n_com_subpop","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"n_subpop","type":"user","source":[8],"depends":null,"lhs":"n_subpop","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"N_temp","type":"expression_array","source":[55],"depends":{"functions":["length","+","["],"variables":["dim_N_temp","S_temp","i","I_temp","alloc_N_temp"]},"lhs":"N_temp","rhs":[{"index":[{"value":[":",1,["length","N_temp"]],"is_range":true,"index":"i"}],"value":["+",["[","S_temp","i"],["[","I_temp","i"]]}]},{"name":"new_I","type":"expression_array","source":[58],"depends":{"functions":["length","rbinom","[","-","exp","/","*"],"variables":["dim_new_I","S_temp","i","beta","I_temp","N_temp","alloc_new_I"]},"lhs":"new_I","rhs":[{"index":[{"value":[":",1,["length","new_I"]],"is_range":true,"index":"i"}],"value":["rbinom",["[","S_temp","i"],["-",1,["exp",["/",["*",["-","beta"],["[","I_temp","i"]],["[","N_temp","i"]]]]]}]},{"name":"new_S","type":"expression_array","source":[59],"depends":{"functions":["length","rbinom","[","-","exp"],"variables":["dim_new_S","I_temp","i","alpha","alloc_new_S"]},"lhs":"new_S","rhs":[{"index":[{"value":[":",1,["length","new_S"]],"is_range":true,"index":"i"}],"value":["rbinom",["[","I_temp","i"],["-",1,["exp",["-","alpha"]]]]}]},{"name":"output_new_I","type":"copy","source":[74],"depends":{"functions":[],"variables":["new_I"]},"lhs":"new_I"},{"name":"output_t_I","type":"copy","source":[75],"depends":{"functions":[],"variables":["t_I"]},"lhs":"t_I"},{"name":"s_initial","type":"user","source":[11],"depends":{"functions":["length"],"variables":["dim_s_initial"]},"lhs":"s_initial","user":{"default":null,"dim":false,"min":null,"max":null}},{"name":"S_prev","type":"expression_array","source":[42,43],"depends":{"functions":["(","+","/","["],"variables":["dim_S_prev","com_p","n_subpop","S","i","N","alloc_S_prev"]},"lhs":"S_prev","rhs":[{"index":[{"value":1,"is_range":false,"index":"i"}],"value":"com_p"},{"index":[{"value":[":",2,["(",["+","n_subpop",1]]],"is_range":true,"index":"i"}],"value":["/",["[","S","i"],["[","N","i"]]}]},{"name":"S_temp","type":"expression_array","source":[53],"depends":{"functions":["length","+","-","[","odin_sum","dim"],"variables":["dim_S_temp","S","i","t_S","dim_t_S","alloc_S_temp"]},"lhs":"S_temp","rhs":[{"index":[{"value":[":",1,["length","S_temp"]],"is_range":true,"index":"i"}],"value":["+",["-",["[","S","i"],["odin_sum","t_S","i","i",1,["dim","t_S",2]]],["odin_sum","t_S",1,["dim","t_S",1],"i","i"]]}]},{"name":"t_I","type":"expression_array","source":[50],"depends":{"functions":["dim","-","["],"variables":["dim_t_I","d","i","j","t_S","alloc_t_I"]},"lhs":"t_I","rhs":[{"index":[{"value":[":",1,["dim","t_I",1]],"is_range":true,"index":"i"},{"value":[":",1,["dim","t_I",2]],"is_range":true,"index":"j"}],"value":["-",["[","d","i","j"],["[","t_S","i","j"]]}]},{"name":"t_S","type":"expression_array","source":[49],"depends":{"functions":["dim","round","/","*","["],"variables":["dim_t_S","d","i","j","S","N","alloc_t_S"]},"lhs":"t_S","rhs":[{"index":[{"value":[":",1,["dim","t_S",1]],"is_range":true,"index":"i"},{"value":[":",1,["dim","t_S",2]],"is_range":true,"index":"j"}],"value":["round",["/",["*",["[","d","i","j"],["[","S","i"]],["[","N","i"]]]}]},{"name":"t_S_out","type":"expression_array","source":[46],"depends":{"functions":["length","rbinom","odin_sum","dim","["],"variables":["dim_t_S_out","d","i","dim_d","S_prev","alloc_t_S_out"]},"lhs":"t_S_out","rhs":[{"index":[{"value":[":",1,["length","t_S_out"]],"is_range":true,"index":"i"}],"value":["rbinom",["odin_sum","d","i","i",1,["dim","d",2]],["[","S_prev","i"]]}]},{"name":"update_I","type":"expression_array","source":[62],"depends":{"functions":["length","-","+","["],"variables":["dim_I","I_temp","i","new_I","new_S"]},"lhs":"I","rhs":[{"index":[{"value":[":",1,["length","I"]],"is_range":true,"index":"i"}],"value":["-",["+",["[","I_temp","i"],["[","new_I","i"]],["[","new_S","i"]]}]},{"name":"update_S","type":"expression_array","source":[61],"depends":{"functions":["length","+","-","["],"variables":["dim_S","S_temp","i","new_I","new_S"]},"lhs":"S","rhs":[{"index":[{"value":[":",1,["length","S"]],"is_range":true,"index":"i"}],"value":["+",["-",["[","S_temp","i"],["[","new_I","i"]],["[","new_S","i"]]}]}],"debug":[],"components":{"create":{"variables":[],"equations":[]},"user":{"variables":[],"equations":["alpha","beta","com_p","n_com_subpop","n_subpop","dim_d_1","dim_d_2","dim_I","dim_i_initial","dim_I_temp","dim_N","dim_N_temp","dim_new_I","dim_new_S","dim_S","dim_s_initial","dim_S_prev","dim_S_temp","dim_t_I_1","dim_t_I_2","dim_t_S_1","dim_t_S_2","dim_t_S_out","alloc_I_temp","alloc_initial_I","alloc_initial_S","alloc_N_temp","alloc_new_I","alloc_new_S","alloc_S_prev","alloc_S_temp","alloc_t_S_out","dim_d","dim_t_I","dim_t_S","i_initial","N","s_initial","alloc_t_I","alloc_t_S","d","initial_I","initial_S"]},"initial":{"variables":[],"equations":[]},"rhs":{"variables":["S","I"],"equations":["t_S","S_temp","t_I","I_temp","N_temp","new_S","new_I","update_I","update_S"]},"update_stochastic":{"variables":[],"equations":[]},"output":{"variables":["S","I"],"equations":["t_S","S_temp","t_I","I_temp","output_t_I","N_temp","new_I","output_new_I"]}},"user":[{"name":"alpha","has_default":false},{"name":"beta","has_default":false},{"name":"com_p","has_default":false},{"name":"d","has_default":false},{"name":"i_initial","has_default":false},{"name":"N","has_default":false},{"name":"n_com_subpop","has_default":false},{"name":"n_subpop","has_default":false},{"name":"s_initial","has_default":false}],"interpolate":{"min":[],"max":[],"critical":[]},"source":["##############################","# PARAMETERS","##############################","# User-specified parameters","beta <- user()","alpha <- user()","","n_subpop <- user()","n_com_subpop <- user()","","s_initial[] <- user()","i_initial[] <- user()","N[] <- user()","d[,] <- user()","","com_p <- user()","","# Dimension of variables","dim(S) <- n_subpop","dim(I) <- n_subpop","dim(S_temp) <- n_subpop","dim(I_temp) <- n_subpop","dim(new_S) <- n_subpop","dim(new_I) <- n_subpop","dim(s_initial) <- n_subpop","dim(i_initial) <- n_subpop","dim(N) <- n_subpop","dim(N_temp) <- n_subpop","","dim(S_prev) <- n_com_subpop","","dim(d) <- c(n_com_subpop, n_com_subpop)","dim(t_S_out) <- n_com_subpop","dim(t_S) <- c(n_com_subpop, n_com_subpop)","dim(t_I) <- c(n_com_subpop, n_com_subpop)","","##############################","# MODEL","##############################","# 1. TRAVEL STEP----------------------------","# Prevalence of susceptible","S_prev[1] <- com_p","S_prev[2:(n_subpop+1)] <- S[i]/N[i]","","# Vector of transferred susceptible","t_S_out[] <- rbinom(sum(d[i,]), S_prev[i])","","# Number of transfers between hospitals","t_S[,] <- round(d[i,j]*S[i]/N[i])","t_I[,] <- d[i,j]-t_S[i,j]","","# Update compartments","S_temp[] <- S[i] - sum(t_S[i,]) + sum(t_S[,i])","I_temp[] <- I[i] - sum(t_I[i,]) + sum(t_I[,i])","N_temp[] <- S_temp[i] + I_temp[i]","","# 2. STEP EPIDEMICS--------------------------","new_I[] <- rbinom(S_temp[i], 1-exp(-beta*I_temp[i]/N_temp[i]))","new_S[] <- rbinom(I_temp[i], 1-exp(-alpha))","","update(S[]) <- S_temp[i] - new_I[i] + new_S[i]","update(I[]) <- I_temp[i] + new_I[i] - new_S[i]","","##############################","# INITIAL CONDITIONS","##############################","initial(S[]) <- s_initial[i]","initial(I[]) <- i_initial[i]","","##############################","# ADDITIONNAL VARIABLES TO","# STORE AT EACH TIME STEP","##############################","output(new_I[]) <- TRUE","output(t_I[,]) <- TRUE"]}
